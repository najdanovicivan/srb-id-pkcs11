const pkcs = @cImport({
    @cInclude("pkcs.h");
});

pub const PkcsError = error{
    Cancel,
    HostMemory,
    SlotIdInvalid,
    GeneralError,
    FunctionFailed,
    ArgumentsBad,
    NoEvent,
    NEED_TO_CREATE_THREADS,
    CANT_LOCK,
    ATTRIBUTE_READ_ONLY,
    ATTRIBUTE_SENSITIVE,
    ATTRIBUTE_TYPE_INVALID,
    ATTRIBUTE_VALUE_INVALID,
    ACTION_PROHIBITED,
    DATA_INVALID,
    DATA_LEN_RANGE,
    DeviceError,
    DeviceMemory,
    DeviceRemoved,
    ENCRYPTED_DATA_INVALID,
    ENCRYPTED_DATA_LEN_RANGE,
    FUNCTION_CANCELED,
    FUNCTION_NOT_PARALLEL,
    FUNCTION_NOT_SUPPORTED,
    KEY_HANDLE_INVALID,
    KEY_SIZE_RANGE,
    KEY_TYPE_INCONSISTENT,
    KEY_NOT_NEEDED,
    KEY_CHANGED,
    KEY_NEEDED,
    KEY_INDIGESTIBLE,
    KEY_FUNCTION_NOT_PERMITTED,
    KEY_NOT_WRAPPABLE,
    KEY_UNEXTRACTABLE,
    MECHANISM_INVALID,
    MECHANISM_PARAM_INVALID,
    OBJECT_HANDLE_INVALID,
    OPERATION_ACTIVE,
    OPERATION_NOT_INITIALIZED,
    PIN_INCORRECT,
    PIN_INVALID,
    PIN_LEN_RANGE,
    PIN_EXPIRED,
    PIN_LOCKED,
    SessionClosed,
    SESSION_COUNT,
    SessionHandleInvalid,
    SESSION_PARALLEL_NOT_SUPPORTED,
    SESSION_READ_ONLY,
    SESSION_EXISTS,
    SESSION_READ_ONLY_EXISTS,
    SESSION_READ_WRITE_SO_EXISTS,
    SIGNATURE_INVALID,
    SIGNATURE_LEN_RANGE,
    TEMPLATE_INCOMPLETE,
    TEMPLATE_INCONSISTENT,
    TokenNoPresent,
    TokenNotRecognized,
    TOKEN_WRITE_PROTECTED,
    UNWRAPPING_KEY_HANDLE_INVALID,
    UNWRAPPING_KEY_SIZE_RANGE,
    UNWRAPPING_KEY_TYPE_INCONSISTENT,
    USER_ALREADY_LOGGED_IN,
    UserNotLoggedIn,
    USER_PIN_NOT_INITIALIZED,
    USER_TYPE_INVALID,
    USER_ANOTHER_ALREADY_LOGGED_IN,
    USER_TOO_MANY_TYPES,
    WRAPPED_KEY_INVALID,
    WRAPPED_KEY_LEN_RANGE,
    WRAPPING_KEY_HANDLE_INVALID,
    WRAPPING_KEY_SIZE_RANGE,
    WRAPPING_KEY_TYPE_INCONSISTENT,
    RANDOM_SEED_NOT_SUPPORTED,
    RANDOM_NO_RNG,
    DOMAIN_PARAMS_INVALID,
    CURVE_NOT_SUPPORTED,
    BUFFER_TOO_SMALL,
    SAVED_STATE_INVALID,
    INFORMATION_SENSITIVE,
    STATE_UNSAVEABLE,
    CryptokiNotInitialized,
    CRYPTOKI_ALREADY_INITIALIZED,
    MUTEX_BAD,
    MUTEX_NOT_LOCKED,
    NEW_PIN_MODE,
    NEXT_OTP,
    EXCEEDED_MAX_ITERATIONS,
    FIPS_SELF_TEST_FAILED,
    LIBRARY_LOAD_FAILED,
    PIN_TOO_WEAK,
    PUBLIC_KEY_INVALID,
    FUNCTION_REJECTED,
    VENDOR_DEFINED,
};

pub fn toRV(err: PkcsError) pkcs.CK_RV {
    return switch (err) {
        PkcsError.Cancel => pkcs.CKR_CANCEL,
        PkcsError.HostMemory => pkcs.CKR_HOST_MEMORY,
        PkcsError.SlotIdInvalid => pkcs.CKR_SLOT_ID_INVALID,
        PkcsError.GeneralError => pkcs.CKR_GENERAL_ERROR,
        PkcsError.FunctionFailed => pkcs.CKR_FUNCTION_FAILED,
        PkcsError.ArgumentsBad => pkcs.CKR_ARGUMENTS_BAD,
        PkcsError.NoEvent => pkcs.CKR_NO_EVENT,
        PkcsError.NEED_TO_CREATE_THREADS => pkcs.CKR_NEED_TO_CREATE_THREADS,
        PkcsError.CANT_LOCK => pkcs.CKR_CANT_LOCK,
        PkcsError.ATTRIBUTE_READ_ONLY => pkcs.CKR_ATTRIBUTE_READ_ONLY,
        PkcsError.ATTRIBUTE_SENSITIVE => pkcs.CKR_ATTRIBUTE_SENSITIVE,
        PkcsError.ATTRIBUTE_TYPE_INVALID => pkcs.CKR_ATTRIBUTE_TYPE_INVALID,
        PkcsError.ATTRIBUTE_VALUE_INVALID => pkcs.CKR_ATTRIBUTE_VALUE_INVALID,
        PkcsError.ACTION_PROHIBITED => pkcs.CKR_ACTION_PROHIBITED,
        PkcsError.DATA_INVALID => pkcs.CKR_DATA_INVALID,
        PkcsError.DATA_LEN_RANGE => pkcs.CKR_DATA_LEN_RANGE,
        PkcsError.DeviceError => pkcs.CKR_DEVICE_ERROR,
        PkcsError.DeviceMemory => pkcs.CKR_DEVICE_MEMORY,
        PkcsError.DeviceRemoved => pkcs.CKR_DEVICE_REMOVED,
        PkcsError.ENCRYPTED_DATA_INVALID => pkcs.CKR_ENCRYPTED_DATA_INVALID,
        PkcsError.ENCRYPTED_DATA_LEN_RANGE => pkcs.CKR_ENCRYPTED_DATA_LEN_RANGE,
        PkcsError.FUNCTION_CANCELED => pkcs.CKR_FUNCTION_CANCELED,
        PkcsError.FUNCTION_NOT_PARALLEL => pkcs.CKR_FUNCTION_NOT_PARALLEL,
        PkcsError.FUNCTION_NOT_SUPPORTED => pkcs.CKR_FUNCTION_NOT_SUPPORTED,
        PkcsError.KEY_HANDLE_INVALID => pkcs.CKR_KEY_HANDLE_INVALID,
        PkcsError.KEY_SIZE_RANGE => pkcs.CKR_KEY_SIZE_RANGE,
        PkcsError.KEY_TYPE_INCONSISTENT => pkcs.CKR_KEY_TYPE_INCONSISTENT,
        PkcsError.KEY_NOT_NEEDED => pkcs.CKR_KEY_NOT_NEEDED,
        PkcsError.KEY_CHANGED => pkcs.CKR_KEY_CHANGED,
        PkcsError.KEY_NEEDED => pkcs.CKR_KEY_NEEDED,
        PkcsError.KEY_INDIGESTIBLE => pkcs.CKR_KEY_INDIGESTIBLE,
        PkcsError.KEY_FUNCTION_NOT_PERMITTED => pkcs.CKR_KEY_FUNCTION_NOT_PERMITTED,
        PkcsError.KEY_NOT_WRAPPABLE => pkcs.CKR_KEY_NOT_WRAPPABLE,
        PkcsError.KEY_UNEXTRACTABLE => pkcs.CKR_KEY_UNEXTRACTABLE,
        PkcsError.MECHANISM_INVALID => pkcs.CKR_MECHANISM_INVALID,
        PkcsError.MECHANISM_PARAM_INVALID => pkcs.CKR_MECHANISM_PARAM_INVALID,
        PkcsError.OBJECT_HANDLE_INVALID => pkcs.CKR_OBJECT_HANDLE_INVALID,
        PkcsError.OPERATION_ACTIVE => pkcs.CKR_OPERATION_ACTIVE,
        PkcsError.OPERATION_NOT_INITIALIZED => pkcs.CKR_OPERATION_NOT_INITIALIZED,
        PkcsError.PIN_INCORRECT => pkcs.CKR_PIN_INCORRECT,
        PkcsError.PIN_INVALID => pkcs.CKR_PIN_INVALID,
        PkcsError.PIN_LEN_RANGE => pkcs.CKR_PIN_LEN_RANGE,
        PkcsError.PIN_EXPIRED => pkcs.CKR_PIN_EXPIRED,
        PkcsError.PIN_LOCKED => pkcs.CKR_PIN_LOCKED,
        PkcsError.SessionClosed => pkcs.CKR_SESSION_CLOSED,
        PkcsError.SESSION_COUNT => pkcs.CKR_SESSION_COUNT,
        PkcsError.SessionHandleInvalid => pkcs.CKR_SESSION_HANDLE_INVALID,
        PkcsError.SESSION_PARALLEL_NOT_SUPPORTED => pkcs.CKR_SESSION_PARALLEL_NOT_SUPPORTED,
        PkcsError.SESSION_READ_ONLY => pkcs.CKR_SESSION_READ_ONLY,
        PkcsError.SESSION_EXISTS => pkcs.CKR_SESSION_EXISTS,
        PkcsError.SESSION_READ_ONLY_EXISTS => pkcs.CKR_SESSION_READ_ONLY_EXISTS,
        PkcsError.SESSION_READ_WRITE_SO_EXISTS => pkcs.CKR_SESSION_READ_WRITE_SO_EXISTS,
        PkcsError.SIGNATURE_INVALID => pkcs.CKR_SIGNATURE_INVALID,
        PkcsError.SIGNATURE_LEN_RANGE => pkcs.CKR_SIGNATURE_LEN_RANGE,
        PkcsError.TEMPLATE_INCOMPLETE => pkcs.CKR_TEMPLATE_INCOMPLETE,
        PkcsError.TEMPLATE_INCONSISTENT => pkcs.CKR_TEMPLATE_INCONSISTENT,
        PkcsError.TokenNoPresent => pkcs.CKR_TOKEN_NOT_PRESENT,
        PkcsError.TokenNotRecognized => pkcs.CKR_TOKEN_NOT_RECOGNIZED,
        PkcsError.TOKEN_WRITE_PROTECTED => pkcs.CKR_TOKEN_WRITE_PROTECTED,
        PkcsError.UNWRAPPING_KEY_HANDLE_INVALID => pkcs.CKR_UNWRAPPING_KEY_HANDLE_INVALID,
        PkcsError.UNWRAPPING_KEY_SIZE_RANGE => pkcs.CKR_UNWRAPPING_KEY_SIZE_RANGE,
        PkcsError.UNWRAPPING_KEY_TYPE_INCONSISTENT => pkcs.CKR_UNWRAPPING_KEY_TYPE_INCONSISTENT,
        PkcsError.USER_ALREADY_LOGGED_IN => pkcs.CKR_USER_ALREADY_LOGGED_IN,
        PkcsError.UserNotLoggedIn => pkcs.CKR_USER_NOT_LOGGED_IN,
        PkcsError.USER_PIN_NOT_INITIALIZED => pkcs.CKR_USER_PIN_NOT_INITIALIZED,
        PkcsError.USER_TYPE_INVALID => pkcs.CKR_USER_TYPE_INVALID,
        PkcsError.USER_ANOTHER_ALREADY_LOGGED_IN => pkcs.CKR_USER_ANOTHER_ALREADY_LOGGED_IN,
        PkcsError.USER_TOO_MANY_TYPES => pkcs.CKR_USER_TOO_MANY_TYPES,
        PkcsError.WRAPPED_KEY_INVALID => pkcs.CKR_WRAPPED_KEY_INVALID,
        PkcsError.WRAPPED_KEY_LEN_RANGE => pkcs.CKR_WRAPPED_KEY_LEN_RANGE,
        PkcsError.WRAPPING_KEY_HANDLE_INVALID => pkcs.CKR_WRAPPING_KEY_HANDLE_INVALID,
        PkcsError.WRAPPING_KEY_SIZE_RANGE => pkcs.CKR_WRAPPING_KEY_SIZE_RANGE,
        PkcsError.WRAPPING_KEY_TYPE_INCONSISTENT => pkcs.CKR_WRAPPING_KEY_TYPE_INCONSISTENT,
        PkcsError.RANDOM_SEED_NOT_SUPPORTED => pkcs.CKR_RANDOM_SEED_NOT_SUPPORTED,
        PkcsError.RANDOM_NO_RNG => pkcs.CKR_RANDOM_NO_RNG,
        PkcsError.DOMAIN_PARAMS_INVALID => pkcs.CKR_DOMAIN_PARAMS_INVALID,
        PkcsError.CURVE_NOT_SUPPORTED => pkcs.CKR_CURVE_NOT_SUPPORTED,
        PkcsError.BUFFER_TOO_SMALL => pkcs.CKR_BUFFER_TOO_SMALL,
        PkcsError.SAVED_STATE_INVALID => pkcs.CKR_SAVED_STATE_INVALID,
        PkcsError.INFORMATION_SENSITIVE => pkcs.CKR_INFORMATION_SENSITIVE,
        PkcsError.STATE_UNSAVEABLE => pkcs.CKR_STATE_UNSAVEABLE,
        PkcsError.CryptokiNotInitialized => pkcs.CKR_CRYPTOKI_NOT_INITIALIZED,
        PkcsError.CRYPTOKI_ALREADY_INITIALIZED => pkcs.CKR_CRYPTOKI_ALREADY_INITIALIZED,
        PkcsError.MUTEX_BAD => pkcs.CKR_MUTEX_BAD,
        PkcsError.MUTEX_NOT_LOCKED => pkcs.CKR_MUTEX_NOT_LOCKED,
        PkcsError.NEW_PIN_MODE => pkcs.CKR_NEW_PIN_MODE,
        PkcsError.NEXT_OTP => pkcs.CKR_NEXT_OTP,
        PkcsError.EXCEEDED_MAX_ITERATIONS => pkcs.CKR_EXCEEDED_MAX_ITERATIONS,
        PkcsError.FIPS_SELF_TEST_FAILED => pkcs.CKR_FIPS_SELF_TEST_FAILED,
        PkcsError.LIBRARY_LOAD_FAILED => pkcs.CKR_LIBRARY_LOAD_FAILED,
        PkcsError.PIN_TOO_WEAK => pkcs.CKR_PIN_TOO_WEAK,
        PkcsError.PUBLIC_KEY_INVALID => pkcs.CKR_PUBLIC_KEY_INVALID,
        PkcsError.FUNCTION_REJECTED => pkcs.CKR_FUNCTION_REJECTED,
        PkcsError.VENDOR_DEFINED => pkcs.CKR_VENDOR_DEFINED,
    };
}
